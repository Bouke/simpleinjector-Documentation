

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Simple Injector &mdash; Simple Injector 2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Simple Injector 2 documentation" href="index.html"/>
        <link rel="next" title="Object Lifetime Management" href="lifetimes.html"/>
        <link rel="prev" title="Quick Start" href="quickstart.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Simple Injector</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#a-quick-example">A Quick Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#more-information">More information</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Using Simple Injector</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#resolving-instances">Resolving instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-simple-injector">Configuring Simple Injector</a></li>
<li class="toctree-l2"><a class="reference internal" href="#verifying-the-container-s-configuration">Verifying the container&#8217;s configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-constructor-injection-auto-wiring">Automatic constructor injection / auto-wiring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-information">More information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lifetimes.html">Object Lifetime Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#transient">Transient</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#singleton">Singleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#scoped">Scoped</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-web-request">Per Web Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-web-api-request">Per Web API Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#web-api-request-lifestyle-vs-web-request-lifestyle">Web API Request lifestyle vs. Web Request lifestyle</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-wcf-operation">Per WCF Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-lifetime-scope">Per Lifetime Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-execution-context-scope">Per Execution Context Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-graph">Per Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-thread">Per Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#per-http-session">Per HTTP Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#hybrid">Hybrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html#developing-a-custom-lifestyle">Developing a Custom Lifestyle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Integration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mvcintegration.html">    ASP.NET MVC</a></li>
<li class="toctree-l2"><a class="reference internal" href="webapiintegration.html">    ASP.NET Web API</a></li>
<li class="toctree-l2"><a class="reference internal" href="webformsintegration.html">    ASP.NET Web Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="windowsformsintegration.html">    Windows Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="wcfintegration.html">    WCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="wpfintegration.html">    WPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="silverlightintegration.html">    Silverlight</a></li>
<li class="toctree-l2"><a class="reference internal" href="integration.html#patterns">Patterns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html">Diagnostic Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html#how-to-view-diagnostic-results">How to view diagnostic results</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html#suppressing-warnings">Suppressing warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html#supported-warnings">Supported Warnings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="howto.html">How To</a><ul>
<li class="toctree-l2"><a class="reference internal" href="howto.html#register-factory-delegates">Register factory delegates</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html#resolve-instances-by-key">Resolve instances by key</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html#resolve-arrays-and-lists">Resolve arrays and lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html#register-multiple-interfaces-with-the-same-implementation">Register multiple interfaces with the same implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html#override-existing-registrations">Override existing registrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html#verify-the-container-s-configuration">Verify the container&#8217;s configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html#work-with-dependency-injection-in-multi-threaded-applications">Work with dependency injection in multi-threaded applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Scenarios</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#generics">Generics</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#batch-automatic-registration">Batch / Automatic registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#registration-of-open-generic-types">Registration of open generic types</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#mixing-collections-of-open-generic-and-non-generic-components">Mixing collections of open-generic and non-generic components</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#unregistered-type-resolution">Unregistered type resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#context-based-injection">Context based injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#decorators">Decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#interception">Interception</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#property-injection">Property injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#covariance-and-contravariance">Covariance and Contravariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html#registering-plugins-dynamically">Registering plugins dynamically</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extensibility.html">Extensibility Points</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#overriding-constructor-resolution-behavior">Overriding Constructor Resolution Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#overriding-property-injection-behavior">Overriding Property Injection Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#overriding-parameter-injection-behavior">Overriding Parameter Injection Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#resolving-unregistered-types">Resolving Unregistered Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#overriding-lifestyle-selection-behavior">Overriding Lifestyle Selection Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#intercepting-the-creation-of-types">Intercepting the Creation of Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="extensibility.html#building-up-external-instances">Building up External Instances</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Simple Injector Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html#registration-pipeline">Registration Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html#resolve-pipeline">Resolve Pipeline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="principles.html">Design Principles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="principles.html#make-simple-use-cases-easy-make-complex-use-cases-possible">Make simple use cases easy, make complex use cases possible</a></li>
<li class="toctree-l2"><a class="reference internal" href="principles.html#push-developers-into-best-practices">Push developers into best practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="principles.html#fast-by-default">Fast by default</a></li>
<li class="toctree-l2"><a class="reference internal" href="principles.html#don-t-force-vendor-lock-in">Don&#8217;t force vendor lock-in</a></li>
<li class="toctree-l2"><a class="reference internal" href="principles.html#never-fail-silently">Never fail silently</a></li>
<li class="toctree-l2"><a class="reference internal" href="principles.html#features-should-be-intuitive">Features should be intuitive</a></li>
<li class="toctree-l2"><a class="reference internal" href="principles.html#communicate-errors-clearly-and-describe-how-to-solve-them">Communicate errors clearly and describe how to solve them</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="decisions.html">Design Decisions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#the-container-is-locked-after-the-first-call-to-resolve">The container is locked after the first call to resolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#the-api-clearly-differentiates-the-registration-of-collections">The API clearly differentiates the registration of collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#no-support-for-xml-based-configuration">No support for XML based configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#never-force-users-to-release-what-they-resolve">Never force users to release what they resolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#don-t-allow-resolving-scoped-instances-outside-an-active-scope">Don&#8217;t allow resolving scoped instances outside an active scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#no-out-of-the-box-support-for-property-injection">No out-of-the-box support for property injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#no-out-of-the-box-support-for-interception">No out-of-the-box support for interception</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#limited-batch-registration-api">Limited batch-registration API</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#no-per-thread-lifestyle">No per-thread lifestyle</a></li>
<li class="toctree-l2"><a class="reference internal" href="decisions.html#allow-only-a-single-constructor">Allow only a single constructor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="legal.html">Legal stuff</a><ul>
<li class="toctree-l2"><a class="reference internal" href="legal.html#simple-injector-license">Simple Injector License</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal.html#contributions">Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal.html#simple-injector-trademark-policy">Simple Injector Trademark Policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="RuntimeDecorators.html">Runtime Decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="InterceptionExtensions.html">Interception Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="CollectionRegistrationExtensions.html">Collection Registration Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="ContextDependentExtensions.html">Context Dependent Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="varianceextensions.html">Variance Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="t4mvc.html">T4MVC</a></li>
<li class="toctree-l2"><a class="reference internal" href="injectproperties-is-deprecated.html">InjectProperties is Deprecated</a></li>
<li class="toctree-l2"><a class="reference internal" href="registermvcattributefilterprovider-is-deprecated.html">RegisterMvcAttributeFilterProvider is Deprecated</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://simpleinjector.org/ReferenceLibrary/">API Documentation</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Simple Injector</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Using Simple Injector</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/using.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="using-simple-injector">
<h1>Using Simple Injector<a class="headerlink" href="#using-simple-injector" title="Permalink to this headline">¶</a></h1>
<p>This section will walk you through the basics of Simple Injector. After reading this section, you will have a good idea how to use Simple Injector.</p>
<p id="id1">Good practice is to minimize the dependency between your application and the DI library. This increases the testability and the flexibility of your application, results in cleaner code, and makes it easier to migrate to another DI library (if ever required). The technique for keeping this dependency to a minimum can be achieved by designing the types in your application around the constructor injection pattern: Define all dependencies of a class in the single public constructor of that type; do this for all service types that need to be resolved and resolve only the top most types in the application directly (i.e. let the container build up the complete graph of dependent objects for you).</p>
<p id="the-container">Simple Injector&#8217;s main type is the <a class="reference external" href="https://simpleinjector.org/ReferenceLibrary/?topic=html/T_SimpleInjector_Container.htm">Container</a> class. An instance of <em>Container</em> is used to register mappings between each abstraction (service) and its corresponding implementation (component). Your application code should depend on abstractions and it is the role of the <em>Container</em> to supply the application with the right implementation. The easiest way to view the <em>Container</em> is as a big dictionary where the type of the abstraction is used as key, and each key&#8217;s related value is the definition of how to create that particular implementation. Each time the application requests for a service, a look up is made within the dictionary and the correct implementation is returned.</p>
<div class="note container">
<strong>Tip</strong>: You should typically create a single <em>Container</em> instance for the whole application (one instance per app domain); <em>Container</em> instances are thread-safe.</div>
<div class="note container">
<strong>Warning</strong>: Registering types in a <em>Container</em> instance should be done from one single thread. Requesting instances from the <em>Container</em> is thread-safe but <a class="reference external" href="https://simpleinjector.codeplex.com/discussions/349908">registration is not</a>.</div>
<div class="note container">
<strong>Warning</strong>: Do not create an infinite number of <em>Container</em> instances (such as one instance per request). Doing so will drain the performance of your application. The library is optimized for using a very limited number of <em>Container</em> instances. Creating and initializing <em>Container</em> instance has a large overhead, (but the <em>Container</em> is <a class="reference external" href="https://simpleinjector.codeplex.com/discussions/326621">extremely fast</a> once initialized.</div>
<p>Creating and configuring a <em>Container</em> is done by newing up an instance and calling the <strong>RegisterXXX</strong> overloads to register each of your services:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="kt">var</span> <span class="n">container</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SimpleInjector</span><span class="p">.</span><span class="n">Container</span><span class="p">();</span>

<span class="c1">// Registrations here</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">,</span> <span class="n">FileLogger</span><span class="p">&gt;();</span>
</pre></div>
</div>
<p>Ideally, the only place in an application that should directly reference and use Simple Injector is the startup path. For an ASP.NET Web Forms or MVC application this will usually be the <strong>{&#8220;Application_OnStart&#8221;}</strong> event in the <a class="reference external" href="https://msdn.microsoft.com/en-us/library/1xaas8a2%28VS.71%29.aspx">Global.asax</a> page of the web application project. For a Windows Forms or console application this will be the <em>Main</em> method in the application assembly.</p>
<div class="note container">
<strong>Tip</strong>: For more information about usage of Simple Injector for a specific technology, please see the <a class="reference internal" href="integration.html"><em>Integration Guide</em></a>.</div>
<p>The usage of Simple Injector consists of four or five steps:</p>
<ol class="arabic simple">
<li>Create a new container</li>
<li>Configure the container (<em>Register</em>)</li>
<li>[Optionally] verify the container</li>
<li>Store the container for use by the application</li>
<li>Retrieve instances from the container (<em>Resolve</em>)</li>
</ol>
<p>The first four steps are performed only once at application startup. The last step is usually performed multiple times (usually once per request) for the majority of applications. The first three steps are platform agnostic but the last two steps depend on a mix of personal preference and which presentation framework is being used. Below is an example for the configuration of an ASP.NET MVC application:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="k">using</span> <span class="nn">System.Web.Mvc</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">SimpleInjector</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">SimpleInjector.Integration.Web.Mvc</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Global</span> <span class="p">:</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">HttpApplication</span> <span class="p">{</span>

    <span class="k">protected</span> <span class="k">void</span> <span class="nf">Application_Start</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 1. Create a new Simple Injector container</span>
        <span class="kt">var</span> <span class="n">container</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Container</span><span class="p">();</span>

        <span class="c1">// 2. Configure the container (register)</span>
        <span class="c1">// See below for more configuration examples</span>
        <span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IUserService</span><span class="p">,</span> <span class="n">UserService</span><span class="p">&gt;(</span><span class="n">Lifestyle</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span>
        <span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">,</span> <span class="n">SqlUserRepository</span><span class="p">&gt;(</span><span class="n">Lifestyle</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span>

        <span class="c1">// 3. Optionally verify the container&#39;s configuration.</span>
        <span class="n">container</span><span class="p">.</span><span class="n">Verify</span><span class="p">();</span>

        <span class="c1">// 4. Store the container for use by the application</span>
        <span class="n">DependencyResolver</span><span class="p">.</span><span class="n">SetResolver</span><span class="p">(</span>
            <span class="k">new</span> <span class="nf">SimpleInjectorDependencyResolver</span><span class="p">(</span><span class="n">container</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the case of MVC, the fifth step is the responsibility of the MVC framework. For each received web requests, the MVC framework will map that request to a <em>Controller</em> type and ask the application&#8217;s <em>IDependencyResolver</em> to create an instance of that controller type. The registration of the <strong>SimpleInjectorDependencyResolver</strong> (part of the <strong>SimpleInjector.Integration.Web.Mvc.dll</strong>) will ensure that the request for creating an instance is forwarded on to Simple Injector. Simple Injector will create that controller with all of its nested dependencies.</p>
<p>The example below is a very basic MVC Controller:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Web.Mvc</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">UserController</span> <span class="p">:</span> <span class="n">Controller</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">IUserRepository</span> <span class="n">repository</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">ILogger</span> <span class="n">logger</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">UserController</span><span class="p">(</span><span class="n">IUserRepository</span> <span class="n">repository</span><span class="p">,</span> <span class="n">ILogger</span> <span class="n">logger</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">repository</span> <span class="p">=</span> <span class="n">repository</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">logger</span> <span class="p">=</span> <span class="n">logger</span><span class="p">;</span>
    <span class="p">}</span>

<span class="na">    [HttpGet]</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Index</span><span class="p">(</span><span class="n">Guid</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&quot;Index called.&quot;</span><span class="p">);</span>
        <span class="n">User</span> <span class="n">user</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">repository</span><span class="p">.</span><span class="n">GetById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">View</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="resolving-instances">
<span id="id2"></span><h2>Resolving instances<a class="headerlink" href="#resolving-instances" title="Permalink to this headline">¶</a></h2>
<p>Simple Injector supports two scenarios for retrieving component instances:</p>
<ol class="arabic simple">
<li><strong>Getting an object by a specified type</strong></li>
</ol>
<div class="highlight-c#"><div class="highlight"><pre><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">&gt;();</span>

<span class="c1">// Alternatively, you can use the weakly typed version</span>
<span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="p">(</span><span class="n">IUserRepository</span><span class="p">)</span><span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">IUserRepository</span><span class="p">));</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><strong>Getting a collection of objects by their type</strong></li>
</ol>
<div class="highlight-c#"><div class="highlight"><pre><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ICommand</span><span class="p">&gt;</span> <span class="n">commands</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetAllInstances</span><span class="p">&lt;</span><span class="n">ICommand</span><span class="p">&gt;();</span>

<span class="c1">// Alternatively, you can use the weakly typed version</span>
<span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">commands</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetAllInstances</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ICommand</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-simple-injector">
<span id="usage-configuring-simple-injector"></span><h2>Configuring Simple Injector<a class="headerlink" href="#configuring-simple-injector" title="Permalink to this headline">¶</a></h2>
<p>The <em>Container</em> class consists of several methods that enable registering instances for retrieval when requested by the application. These methods enable most common scenarios. Here are many of these common scenarios with a code example for each:</p>
<p><strong>Configuring an automatically constructed single instance (Singleton) to always be returned:</strong></p>
<p>The following example configures a single instance of type <em>RealUserService</em> to always be returned when an instance of <em>IUserService</em> is requested. The <em>RealUserService</em> will be constructed using <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a>.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IUserService</span><span class="p">,</span> <span class="n">RealUserService</span><span class="p">&gt;();</span>

<span class="c1">// Alternatively you can supply a Lifestyle with the same effect.</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IUserService</span><span class="p">,</span> <span class="n">RealUserService</span><span class="p">&gt;(</span><span class="n">Lifestyle</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span>

<span class="c1">// Usage</span>
<span class="n">IUserService</span> <span class="n">service</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IUserService</span><span class="p">&gt;();</span>
</pre></div>
</div>
<div class="note container">
<strong>Note</strong>: instances that are declared as <em>Single</em> should be thread-safe in a multi-threaded environment.</div>
<p><strong>Configuring a single - manually created - instance (Singleton) to always be returned:</strong></p>
<p>The following example configures a single instance of a manually created object <cite>SqlUserRepository</cite> to always be returned when a type of <cite>IUserRepository</cite> is requested.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">SqlUserRepository</span><span class="p">());</span>

<span class="c1">// Usage</span>
<span class="n">IUserRepository</span> <span class="n">repository</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">&gt;();</span>
</pre></div>
</div>
<div class="note container">
<strong>Note</strong>: Registering types using <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a> (auto-wiring) is the preferred method of registering types. Only new up instances manually when automatic constructor injection is not possible.</div>
<p><strong>Configuring a single instance using a delegate:</strong></p>
<p>This example configures a single instance as a delegate. The <em>Container</em> will ensure that the delegate is only called once.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">UserRepFactory</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="s">&quot;some constr&quot;</span><span class="p">));</span>

<span class="c1">// Alternatively you can supply the singleton Lifestyle with the same effect.</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">UserRepFactory</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="s">&quot;some constr&quot;</span><span class="p">),</span>
    <span class="n">Lifestyle</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span>

<span class="c1">// Usage</span>
<span class="n">IUserRepository</span> <span class="n">repository</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">&gt;();</span>
</pre></div>
</div>
<div class="note container">
<strong>Note</strong>: Registering types using <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a> (auto-wiring) is the recommended method of registering types. Only new up instances manually when automatic constructor injection is not possible.</div>
<p><strong>Configuring an automatically constructed new instance to be returned:</strong></p>
<p>By supplying the service type and the created implementation as generic types, the container can create new instances of the implementation (<em>MoveCustomerHandler</em> in this case) by <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a>.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;,</span> <span class="n">MoveCustomerHandler</span><span class="p">&gt;();</span>

<span class="c1">// Alternatively you can supply the transient Lifestyle with the same effect.</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;,</span> <span class="n">MoveCustomerHandler</span><span class="p">&gt;(</span><span class="n">Lifestyle</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">handler</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;&gt;();</span>
</pre></div>
</div>
<p><strong>Configuring a new instance to be returned on each call using a delegate:</strong></p>
<p>By supplying a delegate, types can be registered that cannot be created by using <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a>.</p>
<div class="note container">
By referencing the <em>Container</em> instance within the delegate, the <em>Container</em> can still manage as much of the object creation work as possible:</div>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;&gt;(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Get a new instance of the concrete MoveCustomerHandler class:</span>
    <span class="kt">var</span> <span class="n">handler</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">MoveCustomerHandler</span><span class="p">&gt;();</span>

    <span class="c1">// Configure the handler:</span>
    <span class="n">handler</span><span class="p">.</span><span class="n">ExecuteAsynchronously</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">handler</span><span class="p">;</span>
<span class="p">});</span>

<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;&gt;(()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">},</span> <span class="n">Lifestyle</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span>
<span class="c1">// Alternatively you can supply the transient Lifestyle with the same effect.</span>
<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">handler</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;&gt;();</span>
</pre></div>
</div>
<p id="configuring-property-injection"><strong>Configuring property injection on an instance:</strong></p>
<p>For types that need to be injected we recommend that you define a single public constructor that contains all dependencies. In scenarios where constructor injection is not possible, property injection is your fallback option. The previous example showed an example of property injection but our preferred approach is to use the <strong>RegisterInitializer</strong> method:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;&gt;,</span> <span class="n">MoveCustomerHandler</span><span class="p">&gt;();</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">ShipOrderCommand</span><span class="p">&gt;&gt;,</span> <span class="n">ShipOrderHandler</span><span class="p">&gt;();</span>

<span class="c1">// MoveCustomerCommand and ShipOrderCommand both inherit from HandlerBase</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterInitializer</span><span class="p">&lt;</span><span class="n">HandlerBase</span><span class="p">&gt;(</span><span class="n">handlerToInitialize</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="n">handlerToInitialize</span><span class="p">.</span><span class="n">ExecuteAsynchronously</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">handler1</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">MoveCustomerCommand</span><span class="p">&gt;&gt;();</span>
<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">handler1</span><span class="p">.</span><span class="n">ExecuteAsynchronously</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">handler2</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IHandler</span><span class="p">&lt;</span><span class="n">ShipOrderCommand</span><span class="p">&gt;&gt;();</span>
<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">handler2</span><span class="p">.</span><span class="n">ExecuteAsynchronously</span><span class="p">);</span>
</pre></div>
</div>
<p>The <em>Action&lt;T&gt;</em> delegate that is registered by the <strong>RegisterInitializer</strong> method is called once the <em>Container</em> has created a new instance of <cite>T</cite> (or any instance that inherits from or implements <cite>T</cite> depending on exactly how you have configured your registrations). In the example <em>MoveCustomerHandler</em> inherits from <em>HandlerBase</em> and because of this the <em>Action&lt;HandlerBase&gt;</em> delegate will be called with a reference to the newly created instance.</p>
<div class="note container">
<strong>Note</strong>: The <em>Ccontainer</em> will not be able to call an initializer delegate on a type that is manually constructed using the <em>new</em> operator. Use <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a> whenever possible.</div>
<div class="note container">
<strong>Tip</strong>: Multiple initializers can be applied to a concrete type and the <em>Container</em> will call all initializers that apply. They are <strong>guaranteed</strong> to run in the same order that they are registered.</div>
<p id="collections"><strong>Configuring a collection of instances to be returned:</strong></p>
<p>Simple Injector contains several methods for registering and resolving collections of types. Here are some examples:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="c1">// Registering a list of instances that will be created by the container.</span>
<span class="c1">// Supplying a collection of types is the preferred way of registering collections.</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterAll</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;(</span><span class="k">typeof</span><span class="p">(</span><span class="n">IMailLogger</span><span class="p">),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">SqlLogger</span><span class="p">));</span>

<span class="c1">// Register a fixed list (these instances should be thread-safe).</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterAll</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">MailLogger</span><span class="p">(),</span> <span class="k">new</span> <span class="n">SqlLogger</span><span class="p">());</span>

<span class="c1">// Using a collection from another subsystem</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterAll</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;(</span><span class="n">Logger</span><span class="p">.</span><span class="n">Providers</span><span class="p">);</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">loggers</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetAllInstances</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;();</span>
</pre></div>
</div>
<div class="note container">
<strong>Note</strong>:  When zero instances are registered using <em>RegisterAll</em>, each call to <em>Container.GetAllInstances</em> will return an empty list.</div>
<p>Just as with normal types, Simple Injector can inject collections of instances into constructors:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Definition</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Service</span> <span class="p">:</span> <span class="n">IService</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;</span> <span class="n">loggers</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">Service</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;</span> <span class="n">loggers</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">loggers</span> <span class="p">=</span> <span class="n">loggers</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="n">IService</span><span class="p">.</span><span class="n">DoStuff</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Log to all loggers</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">logger</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="n">loggers</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">logger</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&quot;Some message&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterAll</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;(</span><span class="k">typeof</span><span class="p">(</span><span class="n">MailLogger</span><span class="p">)),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">SqlLogger</span><span class="p">));</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IService</span><span class="p">,</span> <span class="n">Service</span><span class="p">&gt;();</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IService</span><span class="p">&gt;();</span>
<span class="n">service</span><span class="p">.</span><span class="n">DoStuff</span><span class="p">();</span>
</pre></div>
</div>
<p>The <strong>RegisterAll</strong> overloads that take a collection of <em>Type</em> instances rely on the <em>Container</em> to create an instance of each type just as it would for individual registrations. This means that the same rules we have seen above apply to each item in the collection. Take a look at the following configuration:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">MailLogger</span><span class="p">&gt;(</span><span class="n">Lifestyle</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span>
<span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">,</span> <span class="n">FileLogger</span><span class="p">&gt;();</span>

<span class="n">container</span><span class="p">.</span><span class="n">RegisterAll</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;(</span><span class="k">typeof</span><span class="p">(</span><span class="n">MailLogger</span><span class="p">)),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">SqlLogger</span><span class="p">),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">ILogger</span><span class="p">));</span>
</pre></div>
</div>
<p>When the registered collection of <em>ILogger</em> instances are resolved the <em>Container</em> will resolve each and every one of them applying all the specific rules of their configuration. When no lifestyle registration exists, the type is created with the default <strong>Transient</strong> lifestyle (<em>transient</em> means that a new instance is created every time the returned collection is iterated). In the example, the <em>MailLogger</em> type is registered as <strong>Singleton</strong>, and so each resolved <em>ILogger</em> collection will always have the same instance of <em>MailLogger</em> in their collection.</p>
<p>Since the creation is forwarded, abstract types can also be registered using <strong>RegisterAll</strong>. In the above example the <em>ILogger</em> type itself is registered using <strong>RegisterAll</strong>. This seems like a recursive definition, but it will work nonetheless. In this particular case you could imagine this to be a registration with a default ILogger registration which is also included in the collection of <em>ILogger</em> instances as well.</p>
<p>While resolving collections is useful and also works with <a class="reference internal" href="#automatic-constructor-injection"><em>automatic constructor injection</em></a>, the registration of <em>Composites</em> is preferred over the use of collections as constructor arguments in application code. Register a composite whenever possible, as shown in the example below:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Definition</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">CompositeLogger</span> <span class="p">:</span> <span class="n">ILogger</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">ILogger</span><span class="p">[]</span> <span class="n">loggers</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">CompositeLogger</span><span class="p">(</span><span class="k">params</span> <span class="n">ILogger</span><span class="p">[]</span> <span class="n">loggers</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">loggers</span> <span class="p">=</span> <span class="n">loggers</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Log</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">logger</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="n">loggers</span><span class="p">)</span>
            <span class="n">logger</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Configuration</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IService</span><span class="p">,</span> <span class="n">Service</span><span class="p">&gt;();</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span>
    <span class="k">new</span> <span class="nf">CompositeLogger</span><span class="p">(</span>
        <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">MailLogger</span><span class="p">&gt;(),</span>
        <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">SqlLogger</span><span class="p">&gt;()</span>
    <span class="p">)</span>
<span class="p">);</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IService</span><span class="p">&gt;();</span>
<span class="n">service</span><span class="p">.</span><span class="n">DoStuff</span><span class="p">();</span>
</pre></div>
</div>
<p>When using this approach none of your services need a dependency on <em>IEnumerable&lt;ILogger&gt;</em> - they can all simply have a dependency on the <em>ILogger</em> interface itself.</p>
</div>
<div class="section" id="verifying-the-container-s-configuration">
<span id="verifying-container"></span><h2>Verifying the container&#8217;s configuration<a class="headerlink" href="#verifying-the-container-s-configuration" title="Permalink to this headline">¶</a></h2>
<p>You can optionally call the <em>Verify</em> method of the <em>Container</em>. The <em>Verify</em> method provides a fail-fast mechanism to prevent your application from starting when the <em>Container</em> has been accidentaly misconfigured. The <em>Verify</em> method checks the entire configuration by creating an instance of each registered type.</p>
<p>For more information about creating an application and container configuration that can be succesfully verified, please read the <a class="reference internal" href="howto.html#verify-configuration"><em>How To Verify the container&#8217;s configuration</em></a>.</p>
</div>
<div class="section" id="automatic-constructor-injection-auto-wiring">
<span id="automatic-constructor-injection"></span><h2>Automatic constructor injection / auto-wiring<a class="headerlink" href="#automatic-constructor-injection-auto-wiring" title="Permalink to this headline">¶</a></h2>
<p>Simple Injector uses the public constructor of a registered type and analyzes each constructor argument. The <em>Container</em> will resolve an instance for each argument type and then invoke the constructor using those instances. This mechanism is called <em>Automatic Constructor Injection</em> or <em>auto-wiring</em> and is one of the fundamental features that separates a DI Container from manual injection.</p>
<p>Simple Injector has the following prerequisites to be able to provide auto-wiring:</p>
<ol class="arabic simple">
<li>Each type to be created must be concrete (not abstract, an interface or an open generic type).</li>
<li>The type <em>should</em> have one public constructor (this may be a default constructor and this requirement can be overridden).</li>
<li>All the types of the arguments in that constructor must be resolvable by the <em>Container</em>.</li>
</ol>
<p>Simple Injector can create a type even if it hasn&#8217;t registered in the container by using constructor injection.</p>
<p>The following code shows an example of the use of automatic constructor injection. The example shows an <em>IUserRepository</em> interface with a concrete <em>SqlUserRepository</em> implementation and a concrete <em>UserService</em> class. The <em>UserService</em> class has one public constructor with an <em>IUserRepository</em> argument. Because the dependencies of the <em>UserService</em> are registered, Simple Injector is able to create a new <em>UserService</em> instance.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="c1">// Definitions</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IUserRepository</span> <span class="p">{</span> <span class="p">}</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">SqlUserRepository</span> <span class="p">:</span> <span class="n">IUserRepository</span> <span class="p">{</span> <span class="p">}</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">UserService</span> <span class="p">:</span> <span class="n">IUserService</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nf">UserService</span><span class="p">(</span><span class="n">IUserRepository</span> <span class="n">repository</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Configuration</span>
<span class="kt">var</span> <span class="n">container</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Container</span><span class="p">();</span>

<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IUserRepository</span><span class="p">,</span> <span class="n">SqlUserRepository</span><span class="p">&gt;();</span>
<span class="n">container</span><span class="p">.</span><span class="n">RegisterSingle</span><span class="p">&lt;</span><span class="n">IUserService</span><span class="p">,</span> <span class="n">UserService</span><span class="p">&gt;();</span>

<span class="c1">// Usage</span>
<span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">IUserService</span><span class="p">&gt;();</span>
</pre></div>
</div>
<div class="note container">
<strong>Note</strong>: Because <em>UserService</em> is a concrete type, calling <em>container.GetInstance&lt;UserService&gt;()</em> without registering it explicitly will work. This feature can significantly simplify the <em>Container</em>&#8216;s configuration for more complex scenarios. Always keep in mind that best practice is to program to an interface not a concrete type. Prevent using and depending on concrete types as much possible.</div>
</div>
<div class="section" id="more-information">
<span id="id3"></span><h2>More information<a class="headerlink" href="#more-information" title="Permalink to this headline">¶</a></h2>
<p>For more information about Simple Injector please visit the following links:</p>
<ul class="simple">
<li>The <a class="reference internal" href="lifetimes.html"><em>Object Lifetime Management</em></a> page explains how to configure lifestyles such as <strong>transient</strong>, <strong>singleton</strong>, and many others.</li>
<li>See the <a class="reference internal" href="integration.html"><em>Integration Guide</em></a> for more information about how to integrate Simple Injector into your specific application framework.</li>
<li>For more information about dependency injection in general, please visit <a class="reference external" href="https://stackoverflow.com/tags/dependency-injection/info">this page on Stackoverflow</a>.</li>
<li>If you have any questions about how to use Simple Injector or about dependency injection in general, the experts at <a class="reference external" href="https://stackoverflow.com/questions/ask?tags=simple-injector+%20ioc-container+dependency-injection+.net+c%23">Stackoverflow.com</a> are waiting for you.</li>
<li>For all other Simple Injector related question and discussions, such as bug reports and feature requests, the <a class="reference external" href="https://simpleinjector.codeplex.com/discussions">Simple Injector discussion forum</a> will be the place to start.</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lifetimes.html" class="btn btn-neutral float-right" title="Object Lifetime Management"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral" title="Quick Start"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Simple Injector Contributors.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>